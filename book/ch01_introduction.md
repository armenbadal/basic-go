# Ներածություն

Այս գրքում, որ նախատեսված է ծրագրավորման լեզուների մշակմամբ ու իրականացմամբ հետաքրքրվող ընթերցողի համար, ես պատմում եմ ալգորիթմական լեզվի ինտերպրետատոր գրելու մասին։ Որպես ցուցադրման առարկա ընտրել եմ _Բալ ալգորիթմական լեզուն_։ Այն Բեյսիկ (BASIC), Պիթոն (Python) և ՋավաՍկրիպտ (JavaScript) լեզուների ազդեցությունը կրող մի լեզու է, որն ունի պրոցեդուրային ծրագրավորման լեզուներին յուրահատուկ բոլոր հիմնական հատկանիշները. թվային, տեքստային, տրամաբանական տիպեր, դրանց զանգվածներ, ղեկավարման կառուցվածքներ ու ենթածրագրեր։ Այս նվազագույն միջոցները թույլ են տալիս սահմանել ու իրագործել ալգորիթմների բավականին մեծ տեսականի։

Բալը նախատեսված չէ արտադրական ծրագրավորման համար։ Այն պարզապես մի _փորձարարական նախագիծ_ է, որի օգնությամբ ես ցուցադրում եմ ինտերպրետատոր գրելու հիմնական միջոցներն ու հնարքները։ Այն նաև մի մեծ _վարժություն_ է, որը դո՛ւ, հարգելի ընթերցող, կարող ես ընդլայնել ու հարստացնել։

Բալ ինտերպրետատորը, որպես գործիք, հրամանային տողի արգումենտով ստանում է `*.bas`, `*.bal` կամ `*.բալ` վերջավորությամբ տեքստային ֆայլ, վերլուծում է այդ ֆայլի պարունակությունն ու կառուցում _վերացական շարահյուսական ծառ_ (AST, abstract syntax tree), ապա անցնելով ծառի հանգույցներով՝ կատարում, մեկնաբանում, _ինտերպրետացնում_ է դրանցում գրված տվյալներն ու արտածման ստանդարտ հոսքին դուրս է բերում ինտերպրետացիայի արդյունքը։

![Աշխատանքի գծապատկերը](processing-flow.png)

Օրինակ, եթե `hello.bas` ֆայլում ունենք այսպիսի մի պարզ ծրագիր.

```basic
' առաջին ծրագիրը
SUB Main
  PRINT "Hello, world!"
END SUB
```

ապա, կատարելով `basic hello.bas` հրամանը, արտածման ստանդարտ հոսքին կտեսնենք `Hello, world!` տեքստը.

```bash
$ basic ./hello.bas
Hello, world!
```

Մեկ այլ օրինակ։ Ստորև բերված ծրագրում սահմանված է տրված ամբողջ թվի ֆակտորիալը անդրադարձ (ռեկուրսիվ) եղանակաով հաշվող `Factorial` ենթածրագիրը։ `Main` ենթածրագում հաշվարկվում և արտածվում է 10-ի ֆակտորիալը։

```basic
SUB Factorial(n)
    IF n = 1 THEN
        LET Factorial = 1
    ELSE
        LET Factorial = n * Factorial(n - 1)
    END IF
END SUB

SUB Main
    LET m = Factorial(10)
    PRINT m
END SUB
```

Գրքի շարադրանքը բաղկացած է հինգ գլուխներից.

1. __Լեզվի նկարագրությունը__ գլխում, Բեկուսի-Նաուրի ընդլայնված գրառմամբ (EBNF, Extended Backus-Naur Form) գրառմամբ, սահմանված է _Բալ_ ալգորիթմական լեզուն։ Բերված են օրինակներ։
2. __Վերլուծության ծառ__ գլխում նկարագրվում են _վերացական շարահյուսական ծառի_ հանգույցների տիպերն ու դրանց նշանակությունը։
3. __Շարահյուսական վերլուծություն__ գլխում խոսում եմ ծրագրի տեքստի վերլուծության ու աբստրակտ քերականական ծառի կառուցման մասին։ Այս գլխում եմ պատմում նաև _բառային վերլուծության_ մասին ու _իմաստաբանական վերլուծության_ տարրերի մասին։
4. __Ինտերպրետացիա__ նկարագրում է լեզվի արտահայտությունների հաշվարկման ու հրամանների կատարման եղանակները։ Այստեղ խոսվում է նաև _կատարման/հաշվարկման միջավայրերի_ ու _հաշվարկման արժեքների_ մասին։
5. __Վարժություններ__ գլուխը պարունակում է ինտերպրետատորի զարգացման տարբեր առաջարկներ թե՛ լեզվի ընդլայնման համար, թե՛ եղած հնարավորությունների բարելավման համար։

Ինտերպրետատորն ամբողջությամբ իրականացված է Go լեզվով (այս տեքստը գրելու պահին 1.24 տարբերակը)։ Գո լեզվի ընտրությունը պայմանավորված է նախ՝ դրա պարզությամբ, ապա՝ հարուստ ստանդարտ գրադարանով, նաև՝ քերականությամն նմանությամբ արդյունաբերության և ուսուցման մեջ օգտագործվող լեզուներին։ Իրականացումը բաղկացած է չորս փաթեթներից (package).

1. `ast`, որում սահմանված են վերլուծության ծառի հանգույցների տիպերը և դրանց հետ աշխատելու համար նախատեսված որոշ ֆունկցիաներ ու մեթոդներ։
2. `parser`, որում սահմանված և իրականացված է լեզվի շարահյուսական վերլուծիչը (`parser`): Այստեղ է սահմանված նաև ծրագրի տեքստի բառային վերլուծիչը (`scanner`)։
3. `interpreter`, որում իրականացված է ինտերպրետատորի վարքը՝ վերլուծության ծառի ամեն մի հանգույցի կատարման ֆունցկիաները։ Այստեղ են սահմանված նաև Բալի ներդրված ենթածրագրերը (`builtins`), կատարման ժամանակ հաշվարկված արժեքները պահելու միջավայրը (`environment`): 
4. `main`, որում կազմակերպված է _վերլուծիչի_ ու _ինտերպրետատորի_ կանչը։ Այս փաթեթն է արտածում վերլուծության և ինտերպրետացիայի ժամանակ հայտնաբերված սխալների հաղորդագրությունները։


