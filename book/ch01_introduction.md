# Ներածություն

Հարգելի՛ ընթերցող, երբևէ մտածե՞լ եք, թե ինչպես է աշխատում ծրագրավորման լեզուն։ Ինչպե՞ս են համարյա մարդկային, երբեմն նույնիսկ գեղարվեստական, լեզվով գրված տեքստերը վերածվում մեքենայական հրամանների։ Եթե այս հարցերի պատասխանները ձեզ հետաքրքրում են, ապա մեր այս գիրքը հենց ձե՛զ համար է։ Եթե մի քիչ ծրագրավորում գիտեք, մի քիչ ծանոթ եք հիմնական տվյալների կառուցվածքներին ու ալգորիթմներին և ցանկություն ունեք զգալու, թե նախագծվում ու իրականացվում ծրագրավորման լեզուն, ապա համարձակ կարող եք սկսել ընթերցանությունը։

Այստեղ պատմում ենք ալգորիթմական լեզվի _ինտերպրետատոր_ իրականացնելու մասին։ Որպես ցուցադրման առարկա ընտրել ենք _Բալ ալգորիթմական լեզուն_։ Ինչպես արդեն կռահեցիք, _Բալ_ անունը ստացվել է ռեկուրսիվ սահմանումով. __Բ__՝ Բալ, __Ա__՝ ալգորիթմական, __Լ__՝ լեզու։ Այն Բեյսիկ (BASIC) լեզվի մի ենթատեսակ է՝ ազդված նաև Պիթոն (Python) և ՋավաՍկրիպտ (JavaScript) լեզուներից։  Բալն ունի _պրոցեդուրային_ ծրագրավորման լեզուներին յուրահատուկ բոլոր հիմնական հատկանիշները. թվային, տեքստային, տրամաբանական տիպեր, դրանց զանգվածներ, ղեկավարման կառուցվածքներ ու ենթածրագրեր։ Այս նվազագույն միջոցները թույլ են տալիս սահմանել ու իրագործել ալգորիթմների բավականին մեծ տեսականի։

Բալը _ուսումնական լեզու_ է։ Ավելին, սա պարզապես մի _փորձարարական նախագիծ_ է, որի օգնությամբ ցուցադրում ենք ինտերպրետատոր գրելու հիմնական միջոցներն ու հնարքները։ Այն նաև մի մեծ _վարժություն_ է, որը դո՛ւք, հարգելի՛ ընթերցող, կարող եք ընդլայնել ու հարստացնել։

Բալ ինտերպրետատորը, որպես գործիք, հրամանային տողի արգումենտով ստանում է `*.bas`, `*.bal` կամ `*.բալ` վերջավորությամբ տեքստային ֆայլ, վերլուծում է այդ ֆայլի պարունակությունն ու կառուցում _վերացական շարահյուսական ծառ_ (AST, abstract syntax tree), ապա, անցնելով ծառի հանգույցներով, կատարում, մեկնաբանում, _ինտերպրետացնում_ է դրանցում գրված տվյալներն ու արտածման ստանդարտ հոսքին է դուրս բերում ինտերպրետացիայի արդյունքը։

![Աշխատանքի գծապատկերը](processing-flow.png)

Օրինակ, եթե `hello.bas` ֆայլում ունենք բոլոր ծրագրավորողներին ծանոթ «hello, world» ծրագիր Բալ լեզվով գրված տարբերակը.

```basic
' առաջին ծրագիրը
SUB Main
  PRINT "Hello, world!"
END SUB
```

ապա, հրամանային տողում կատարելով `basic hello.bas` հրամանը, արտածման ստանդարտ հոսքին կտեսնենք `Hello, world!` տեքստը.

```bash
$ basic ./hello.bas
Hello, world!
```

Մեկ այլ օրինակ։ Ստորև բերված ծրագրում սահմանված է տրված ամբողջ թվի ֆակտորիալը անդրադարձ (ռեկուրսիվ) եղանակաով հաշվող `Factorial` ենթածրագիրը։ `Main` ենթածրագում `Factorial`-ը կիրառվում է 10 արժեքին ու արտածվում է արդյունքը։

```basic
SUB Factorial(n)
    IF n = 1 THEN
        LET Factorial = 1
    ELSE
        LET Factorial = n * Factorial(n - 1)
    END IF
END SUB

SUB Main
    LET m = Factorial(10)
    PRINT m
END SUB
```

Գրքի շարադրանքը բաղկացած է հինգ գլուխներից.

1. __Լեզվի նկարագրությունը__ գլխում, Բեկուսի-Նաուրի ընդլայնված գրառմամբ (EBNF, Extended Backus-Naur Form) գրառմամբ, սահմանված է _Բալ_ ալգորիթմական լեզուն։ Բերված են օրինակներ։
2. __Վերլուծության ծառ__ գլխում նկարագրվում են _վերացական շարահյուսական ծառի_ հանգույցների տիպերն ու դրանց նշանակությունը։
3. __Շարահյուսական վերլուծություն__ գլխում խոսում եմ ծրագրի տեքստի վերլուծության ու աբստրակտ քերականական ծառի կառուցման մասին։ Այս գլխում եմ պատմում նաև _բառային վերլուծության_ մասին ու _իմաստաբանական վերլուծության_ տարրերի մասին։
4. __Ինտերպրետացիա__ նկարագրում է լեզվի արտահայտությունների հաշվարկման ու հրամանների կատարման եղանակները։ Այստեղ խոսվում է նաև _կատարման/հաշվարկման միջավայրերի_ ու _հաշվարկման արժեքների_ մասին։
5. __Վարժություններ__ գլուխը պարունակում է ինտերպրետատորի զարգացման տարբեր առաջարկներ թե՛ լեզվի ընդլայնման համար, թե՛ եղած հնարավորությունների բարելավման համար։

Ինտերպրետատորն ամբողջությամբ իրականացված է Go լեզվով (այս տեքստը գրելու պահին 1.24 տարբերակը)։ Գո լեզվի ընտրությունը պայմանավորված է նախ՝ դրա պարզությամբ, ապա՝ հարուստ ստանդարտ գրադարանով, նաև՝ քերականությամն նմանությամբ արդյունաբերության և ուսուցման մեջ օգտագործվող լեզուներին։ Իրականացումը բաղկացած է չորս փաթեթներից (package).

1. `ast`, որում սահմանված են վերլուծության ծառի հանգույցների տիպերը և դրանց հետ աշխատելու համար նախատեսված որոշ ֆունկցիաներ ու մեթոդներ։
2. `parser`, որում սահմանված և իրականացված է լեզվի շարահյուսական վերլուծիչը (`parser`): Այստեղ է սահմանված նաև ծրագրի տեքստի բառային վերլուծիչը (`scanner`)։
3. `interpreter`, որում իրականացված է ինտերպրետատորի վարքը՝ վերլուծության ծառի ամեն մի հանգույցի կատարման ֆունցկիաները։ Այստեղ են սահմանված նաև Բալի ներդրված ենթածրագրերը (`builtins`), կատարման ժամանակ հաշվարկված արժեքները պահելու միջավայրը (`environment`): 
4. `main`, որում կազմակերպված է _վերլուծիչի_ ու _ինտերպրետատորի_ կանչը։ Այս փաթեթն է արտածում վերլուծության և ինտերպրետացիայի ժամանակ հայտնաբերված սխալների հաղորդագրությունները։


